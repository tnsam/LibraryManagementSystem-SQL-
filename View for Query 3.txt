--CHECK NUMBER OF TRANSACTION FOR LECTURER BORROWER TYPE 
CREATE OR REPLACE VIEW LECTURER_TRANS AS
SELECT TO_CHAR(BT.actualReturnDate, 'MONTH') AS "MONTH NAME", 
       EXTRACT(MONTH FROM BT.actualReturnDate) AS "MONTH TRANS", BT.bTransID AS "Transaction ID"
FROM BORROWER_TRANS BT, BORROWER B, BORROWER_TYPE BTYPE
WHERE BT.borrowerID = B.borrowerID AND
      B.borrowerTypeID = BTYPE.borrowerTypeID AND
      BT.borrowerTransStatusID = UPPER('&TRANS_STATUS') AND
      BTYPE.borrowerTypeDesc = 'Lecturer' AND
      EXTRACT(YEAR FROM BT.actualReturnDate) = &INPUT_YEAR
GROUP BY TO_CHAR(BT.actualReturnDate, 'MONTH'), EXTRACT(MONTH FROM BT.actualReturnDate), BT.bTransID
ORDER BY EXTRACT(MONTH FROM BT.actualReturnDate);


CREATE OR REPLACE VIEW LECTURER_MONTHLY_TRANS AS
SELECT 'LECTURER' AS "BORROWER TYPE1", A.*
FROM (SELECT T.calMonth_name AS "MONTH", COUNT(LT."Transaction ID") AS "TOTAL TRANSACTION"
      FROM TEMPCALENDAR T
      LEFT JOIN LECTURER_TRANS LT
      ON LT."MONTH TRANS" = T.calMonth_numYear
      GROUP BY T.calMonth_name, T.calMonth_numYear
      ORDER BY T.calMonth_numYear) A; 


--CHECK NUMBER OF TRANSACTION FOR STUDENT BORROWER TYPE 
CREATE OR REPLACE VIEW STUDENT_TRANS AS
SELECT TO_CHAR(BT.actualReturnDate, 'MONTH') AS "MONTH NAME", 
       EXTRACT(MONTH FROM BT.actualReturnDate) AS "MONTH TRANS", BT.bTransID AS "Transaction ID"
FROM BORROWER_TRANS BT, BORROWER B, BORROWER_TYPE BTYPE
WHERE BT.borrowerID = B.borrowerID AND
      B.borrowerTypeID = BTYPE.borrowerTypeID AND
      BT.borrowerTransStatusID = UPPER('&TRANS_STATUS') AND
      BTYPE.borrowerTypeDesc = 'Student' AND
      EXTRACT(YEAR FROM BT.actualReturnDate) = &INPUT_YEAR
GROUP BY TO_CHAR(BT.actualReturnDate, 'MONTH'), EXTRACT(MONTH FROM BT.actualReturnDate), BT.bTransID
ORDER BY EXTRACT(MONTH FROM BT.actualReturnDate);


CREATE OR REPLACE VIEW STUDENT_MONTHLY_TRANS AS
SELECT 'STUDENT' AS "BORROWER TYPE2", A.*
FROM (SELECT T.calMonth_name AS MONTH, COUNT(ST."Transaction ID") AS "TOTAL TRANSACTION"
      FROM TEMPCALENDAR T
      LEFT JOIN STUDENT_TRANS ST
      ON ST."MONTH TRANS" = T.calMonth_numYear
      GROUP BY T.calMonth_name, T.calMonth_numYear
      ORDER BY T.calMonth_numYear) A;
